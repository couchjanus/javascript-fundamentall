<!DOCTYPE html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
	  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hello cart</title>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="/css/bootstrap.css">

    <script defer src="/fontawesome/js/fontawesome-all.js"></script>
    <link rel="stylesheet" href="/css/main.css">

    <style>
         
    </style>
  </head>

  <body>
    <nav class="navbar">
      <nav class="wrapper">
        <div class="logo"><img src="/images/logo.png"></div><!-- Logo -->
        <input type="checkbox" id="menu-toggle" />
        <label for="menu-toggle" class="label-toggle"></label>
        <ul class="flexmenu">
          <li><a href="index.html">Home</a></li>
          <li><a href="#" id="catalog">Products</a></li>
          <li><a href="blog.html">Blog</a></li>
          <li><a href="contact.html">Contact</a></li>
          <li><a href="#" id="cart-trigger"><i class="fas  fa-shopping-cart"></i>&nbsp;Cart</a></li>
        </ul>
      </nav>
    </nav>
     
    <div class="card text-center">
        <div class="card-header">
          Hello, AJAX!
        </div>
        <div class="card-body">
          <h4 class="card-title">Консоль выполнения запроса:</h4>
          <p class="card-text" id="console">Обрабатываем ответ сервера.</p>
          <a href="#" class="btn btn-primary btnGo">Запустить скрипт</a>
        </div>
        <div class="card-footer text-muted" id="printResult">
          ответ сервера
        </div>
    </div>
  
    
    <!-- Footer Area Start -->
    <footer id="footer">
    </footer>
    <!-- Footer Area Stop -->
    

    
<script src="/js/jquery.min.js"></script>    
<script>
    function CreateRequest()
    {
        var httpRequest = false;

        if (window.XMLHttpRequest)
        {
            //Gecko-совместимые браузеры, Safari, Konqueror
            httpRequest = new XMLHttpRequest();
            httpRequest.overrideMimeType('text/xml');
        }
        else if (window.ActiveXObject)
        {
            //Internet explorer
            try
            {
                 httpRequest = new ActiveXObject("Microsoft.XMLHTTP");
            }    
            catch (CatchException)
            {
                 httpRequest = new ActiveXObject("Msxml2.XMLHTTP");
            }
        }
     
        if (!httpRequest)
        {
            console.log("Невозможно создать XMLHttpRequest");
        }
        
        return httpRequest;
    } 


    document.querySelector('.btnGo').addEventListener('click', function(){

    //Создаём запрос
    
    var request = CreateRequest();

    var url = 'http://headers.jsontest.com/';
    
    //Проверяем существование запроса
    
    if (!request)
    {
        console.log("Невозможно создать XMLHttpRequest");
    }
    else{
    console.log("Ура! Мы создали XMLHttpRequest. Что с ним делать?");

    request.onreadystatechange = function(){
      switch (request.readyState) {
        case 1: print_console('<div class="alert alert-secondary" role="alert">1: Подготовка к отправке...</div>'); break
        case 2: print_console('<div class="alert alert-primary" role="alert">2: Отправлен...</div>'); break
        case 3: print_console('<div class="alert alert-warning" role="alert">3: Идет обмен...</div>'); break
        case 4:{
           try {
           if(request.status==200){
              print_console('<div class="alert alert-success" role="alert">4: Обмен завершен!</div>');
              document.getElementById("printResult").innerHTML = "<b>"+request.responseText+"</b>";
              }else if(request.status==404){
                print_console('<div class="alert alert-danger" role="alert">Ошибка: запрашиваемый скрипт не найден!</div>');
              }
           else {
            print_console('<div class="alert alert-danger" role="alert">Ошибка: сервер вернул статус: '+ request.status +'</div>');
           }

        }
        catch( e ) {
          print_console('<div class="alert alert-danger" role="alert">Произошло исключение:  '+ e.description +'</div>');
        }
        break
        }
       }
      }
       request.open ('GET', url, true);
       this.style.display = 'none';
       request.send ('');
     }
    })

    function print_console(text){
        document.getElementById("console").innerHTML += text;
    }


      </script>
  </body>
</html>
